pval_info <- cbind(pval_metadata, descriptive_stats_df)
if (image_format == "nifti") {
pval_images <- lapply(pval_images, ants2oro)
}
list(pval_info, pval_images)
}
view_itksnap <- function(pval_info,
pval_mask_filter = "brain",
directory_filter = NULL,
segmentation = NULL,
scaling_filter = NULL,
fwhm_filter = NULL,
coefficient_filter = NULL,
mc_correction_filter = NULL,
pca_mask_filter = NULL,
show_image = TRUE) {
if (class(segmentation) == "antsImage") {
segmentation <- ants2oro(segmentation)
}
tmp <- pval_info
if (!is.null(directory_filter)) {
tmp <- tmp %>% filter(directory == directory_filter)
}
if (!is.null(pval_mask_filter)) {
tmp <- tmp %>% filter(pval_mask == pval_mask_filter)
}
if (!is.null(scaling_filter)) {
tmp <- tmp %>% filter(scaling == scaling_filter)
}
if (!is.null(fwhm_filter)) {
tmp <- tmp %>% filter(fwhm == fwhm_filter)
}
if (!is.null(coefficient_filter)) {
tmp <- tmp %>% filter(coefficient == coefficient_filter)
}
if (!is.null(mc_correction_filter)) {
tmp <- tmp %>% filter(mc_correction == mc_correction_filter)
}
if (!is.null(pca_mask_filter)) {
tmp <- tmp %>% filter(pca_mask == pca_mask_filter)
}
print(tmp$prop_sig)
print(tmp$file_path)
file_paths <- tmp$file_paths
if (show_image) {
if (length(file_paths) == 2) {
itksnap(file_paths[1], overlay = file_paths[2], segmentation, verbose = F)
} else {
for (i in 1:length(file_paths)) {
itksnap(file_paths[i], segmentation = segmentation, verbose = F)
}
}
}
return(NULL)
}
adj_pval_dir <- file.path(settings$output_dir, "niftis/pvals/adjusted")
pval_image_stats <- process_pval_images(adj_pval_dir, settings$mask_path, image_format = "nifti")
pval_stats_df <- pval_image_stats[[1]]
view_itksnap(pval_stats_df,
pval_mask_filter = NULL,
directory_filter = "adjusted_gm",
segmentation = gm_mask,
scaling_filter = "unscaled",
fwhm_filter = "fwhm3",
coefficient_filter = NULL,
mc_correction_filter = "fdr05",
pca_mask_filter = "gm-mask",
show_image = TRUE)
pval_dir <- file.path(settings$output_dir, "niftis/pvals")
pval_image_stats <- process_pval_images(file.path(pval_dir, "adjusted"), settings$mask_path, image_format = "nifti")
pval_stats_df <- pval_image_stats[[1]]
write_csv(pval_stats_df, pval_dir)
View(pval_stats_df)
write_csv(pval_stats_df, file.path(pval_dir, "pval_descriptive_stats.csv")
)
get_prop_sig <- function(file_paths, file_labels, atlas, mask) {
pval_masks <- check_ants(file_paths)
masked_atlas <- atlas * mask
network_ids <- masked_atlas[masked_atlas != 0] %>%
as.factor() %>%
summary() %>%
names()
common_mask <- atlas * mask
common_mask[common_mask != 0] <- 1
sig_voxel_images <- lapply(pval_masks, function(pval_mask) pval_mask * masked_atlas)
nonsig_voxel_images <- lapply(pval_masks, function(pval_mask) (-pval_mask + 1) * masked_atlas)
for (i in 1:4) {
sig_sum <- sum(sig_voxel_images[[i]] != 0)
nonsig_sum <- sum(nonsig_voxel_images[[i]] != 0)
if (sum(common_mask) != nonsig_sum + sig_sum) {
stop()
}
}
summaries <- mapply(
function(sig_voxel_image, nonsig_voxel_image, file_label, network_id) {
sig_summary <- sig_voxel_image[sig_voxel_image != 0] %>%
as.factor() %>%
summary() %>%
as.data.frame() %>%
rownames_to_column() %>%
rename(sig_counts = ".")
nonsig_summary <- nonsig_voxel_image[nonsig_voxel_image != 0] %>%
as.factor() %>%
summary() %>%
as.data.frame() %>%
rownames_to_column() %>%
rename(nonsig_counts = ".")
map_name <- rep(file_label, length(network_ids))
df <- data.frame(network_ids) %>%
cbind(map_name) %>%
left_join(sig_summary, by = c("network_ids" = "rowname")) %>%
left_join(nonsig_summary, by = c("network_ids" = "rowname"))
return(df)
},
sig_voxel_images, nonsig_voxel_images, file_labels,
MoreArgs = list(network_ids),
SIMPLIFY = FALSE)
summaries_df <- bind_rows(summaries) %>%
mutate(proportion = sig_counts / (sig_counts + nonsig_counts),
se = sqrt(proportion * (1 - proportion) / (sig_counts + nonsig_counts))
)
return(summaries_df)
}
# ------------------------------------------------
dir <- "three_modality/pvals"
pval_metadata <- read_csv(file.path(dir, "pval_metadata.csv"))
gm_mask <- check_ants("PNC/pnc/mask/gm10_pcals_rest.nii.gz")
yeo7 <- check_ants("atlases/7yeonetworkPNC.nii.gz")
aal <- check_ants("atlases/AAL_atlas_PNC.nii.gz")
# transform aal to yeo7-style mask
aal_sym <- floor(aal/10) * 10
all_indices <- unique(aal_sym)
subcortical_indices <- c(4100, 4200, 7000, 7010, 7020, 7100) # What are the subcortical structures?
excluded_indices <- all_indices[!all_indices %in% subcortical_indices]
for(i in 1:length(excluded_indices)) {
aal_sym[aal_sym == excluded_indices[i]] <- 0
}
file_labels <- c("global_age", "global_sex", "unscaled_age", "unscaled_sex")
pvals_dir <- file.path(settings$output_dir, "niftis/pvals")
pval_metadata <- read_csv(file.path(pvals_dir, "pval_metadata.csv"))
yeo7 <- file.path(settings$input_dir, "references/atlases") %>% check_ants("7yeonetworkPNC.nii.gz")
yeo7 <- file.path(settings$input_dir, "references/atlases") %>% check_ants("7yeonetworkPNC.nii.gz")
yeo7 <- file.path(settings$input_dir, "references/atlases/7yeonetworkPNC.nii.gz) %>% check_ants()
aal <- check_ants("atlases/AAL_atlas_PNC.nii.gz")
# transform aal to yeo7-style mask
aal_sym <- floor(aal/10) * 10
all_indices <- unique(aal_sym)
subcortical_indices <- c(4100, 4200, 7000, 7010, 7020, 7100) # What are the subcortical structures?
excluded_indices <- all_indices[!all_indices %in% subcortical_indices]
for(i in 1:length(excluded_indices)) {
aal_sym[aal_sym == excluded_indices[i]] <- 0
}
file_labels <- c("global_age", "global_sex", "unscaled_age", "unscaled_sex")
# ---------------------------------------------
# get file paths
file_paths <- pval_metadata %>%
filter(fwhm == "fwhm3",
pca_mask == "gm-mask",
coefficient == "sex" | coefficient == "age",
mc_correction == "fdr05") %>%
pull(file_paths)
yeo7_df <- get_prop_sig(file_paths, file_labels, yeo7, gm_mask)
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
aal_sym_df <- get_prop_sig(file_paths, file_labels, aal_sym, gm_mask)
ggplot(aal_sym_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on AAL") +
scale_x_discrete(labels = c("Hippocampus", "Amygdala", "Caudate", "Putamen", "Pallidum", "Thalamus")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
# ---------------------------------------------------
# raw_file_paths <- file.path(dir, "adjusted_gm") %>%
#     list.files()
# raw_file_path_select <- raw_file_paths %>%
#     (function(x) grepl("alff|cbf", x) &
#          grepl("_sex_|_age_", x) &
#          grepl("bonferroni", x))
# raw_file_paths <- file.path(file.path(dir, "adjusted_gm"), raw_file_paths[raw_file_path_select])
# raw_file_labels <- c("alff_age", "alff_sex", "cbf_age", "cbf_sex")
#
# yeo7_df_raw <- get_prop_sig(raw_file_paths, raw_file_labels, yeo7, gm_mask)
# ggplot(yeo7_df_raw, aes(network_ids, proportion)) +
#     geom_col() +
#     geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
#                   position = position_dodge(.9)) +
#     facet_wrap(~ map_name) +
#     labs(title = "Raw on Yeo7") +
#     theme_classic()
#
# aal_sym_df_raw <- get_prop_sig(raw_file_paths, raw_file_labels, aal_sym, gm_mask)
# ggplot(aal_sym_df_raw, aes(network_ids, proportion)) +
#     geom_col() +
#     geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
#                   position = position_dodge(.9)) +
#     facet_wrap(~ map_name) +
#     labs(title = "Raw on AAL") +
#     theme_classic()
# Run through local
```
yeo7 <- file.path(settings$input_dir, "references/atlases/7yeonetworkPNC.nii.gz") %>% check_ants()
aal <- file.path(settings$input_dir, "references/atlases/17yeonetworkPNC.nii.gz") %>% check_ants()
aal <- file.path(settings$input_dir, "references/atlases/AAL_atlas_PNC.nii.gz") %>% check_ants()
# transform aal to yeo7-style mask
aal_sym <- floor(aal/10) * 10
all_indices <- unique(aal_sym)
subcortical_indices <- c(4100, 4200, 7000, 7010, 7020, 7100) # What are the subcortical structures?
excluded_indices <- all_indices[!all_indices %in% subcortical_indices]
for(i in 1:length(excluded_indices)) {
aal_sym[aal_sym == excluded_indices[i]] <- 0
}
file_labels <- c("global_age", "global_sex", "unscaled_age", "unscaled_sex")
# get file paths
file_paths <- pval_metadata %>%
filter(coefficient == "sex" | coefficient == "age",
mc_correction == "fdr05") %>%
pull(file_paths)
pval_metadata <- read_csv(file.path(pvals_dir, "pval_metadata.csv"))
write_csv(pval_stats_df, file.path(settings$output_dir, "csvs/pval_descriptive_stats.csv"))
pval_metadata <- read_csv(file.path(pvals_dir, "pval_descriptive_stats.csv"))
pval_metadata <- read_csv(file.path(settings$output_dir, "csvs", "pval_descriptive_stats.csv"))
# get file paths
file_paths <- pval_metadata %>%
filter(coefficient == "sex" | coefficient == "age",
mc_correction == "fdr05") %>%
pull(file_paths)
file_paths
yeo7_df <- get_prop_sig(file_paths, file_labels, yeo7, gm_mask)
get_prop_sig <- function(file_paths, file_labels, atlas, mask) {
pval_masks <- check_ants(file_paths)
mask <- check_ants(mask)
masked_atlas <- atlas * mask
network_ids <- masked_atlas[masked_atlas != 0] %>%
as.factor() %>%
summary() %>%
names()
common_mask <- atlas * mask
common_mask[common_mask != 0] <- 1
sig_voxel_images <- lapply(pval_masks, function(pval_mask) pval_mask * masked_atlas)
nonsig_voxel_images <- lapply(pval_masks, function(pval_mask) (-pval_mask + 1) * masked_atlas)
for (i in 1:4) {
sig_sum <- sum(sig_voxel_images[[i]] != 0)
nonsig_sum <- sum(nonsig_voxel_images[[i]] != 0)
if (sum(common_mask) != nonsig_sum + sig_sum) {
stop()
}
}
summaries <- mapply(
function(sig_voxel_image, nonsig_voxel_image, file_label, network_id) {
sig_summary <- sig_voxel_image[sig_voxel_image != 0] %>%
as.factor() %>%
summary() %>%
as.data.frame() %>%
rownames_to_column() %>%
rename(sig_counts = ".")
nonsig_summary <- nonsig_voxel_image[nonsig_voxel_image != 0] %>%
as.factor() %>%
summary() %>%
as.data.frame() %>%
rownames_to_column() %>%
rename(nonsig_counts = ".")
map_name <- rep(file_label, length(network_ids))
df <- data.frame(network_ids) %>%
cbind(map_name) %>%
left_join(sig_summary, by = c("network_ids" = "rowname")) %>%
left_join(nonsig_summary, by = c("network_ids" = "rowname"))
return(df)
},
sig_voxel_images, nonsig_voxel_images, file_labels,
MoreArgs = list(network_ids),
SIMPLIFY = FALSE)
summaries_df <- bind_rows(summaries) %>%
mutate(proportion = sig_counts / (sig_counts + nonsig_counts),
se = sqrt(proportion * (1 - proportion) / (sig_counts + nonsig_counts))
)
return(summaries_df)
}
yeo7_df <- get_prop_sig(file_paths, file_labels, yeo7, settings$mask_path)
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) %>%
ggsave(file.path(settings$output_dir, "figures"), .)
test <- ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
?ggsave
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) %>%
ggsave(file.path(settings$output_dir, "figures", "yeo7_barplot.png"), .)
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) %>%
ggsave(file.path(settings$output_dir, "figures", "yeo7_barplot.png"), .)
capabilities?
capabilities()
Sys.setenv("DISPLAY"=":0")
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) %>%
ggsave(file.path(settings$output_dir, "figures", "yeo7_barplot.png"), .)
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
data(mtcars)
plot(mtcars$mpg, mtcars$cyl)
pvals_dir <- file.path(settings$output_dir, "niftis/pvals")
pval_metadata <- read_csv(file.path(settings$output_dir, "csvs", "pval_descriptive_stats.csv"))
yeo7 <- file.path(settings$input_dir, "references/atlases/7yeonetworkPNC.nii.gz") %>% check_ants()
aal <- file.path(settings$input_dir, "references/atlases/AAL_atlas_PNC.nii.gz") %>% check_ants()
# transform aal to yeo7-style mask
aal_sym <- floor(aal/10) * 10
all_indices <- unique(aal_sym)
subcortical_indices <- c(4100, 4200, 7000, 7010, 7020, 7100) # What are the subcortical structures?
excluded_indices <- all_indices[!all_indices %in% subcortical_indices]
for(i in 1:length(excluded_indices)) {
aal_sym[aal_sym == excluded_indices[i]] <- 0
}
file_labels <- c("global_age", "global_sex", "unscaled_age", "unscaled_sex")
# get file paths
file_paths <- pval_metadata %>%
filter(coefficient == "sex" | coefficient == "age",
mc_correction == "fdr05") %>%
pull(file_paths)
yeo7_df <- get_prop_sig(file_paths, file_labels, yeo7, settings$mask_path)
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
aal_sym_df <- get_prop_sig(file_paths, file_labels, aal_sym, gm_mask)
ggplot(aal_sym_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on AAL") +
scale_x_discrete(labels = c("Hippocampus", "Amygdala", "Caudate", "Putamen", "Pallidum", "Thalamus")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
# ---------------------------------------------------
# raw_file_paths <- file.path(dir, "adjusted_gm") %>%
#     list.files()
# raw_file_path_select <- raw_file_paths %>%
#     (function(x) grepl("alff|cbf", x) &
#          grepl("_sex_|_age_", x) &
#          grepl("bonferroni", x))
# raw_file_paths <- file.path(file.path(dir, "adjusted_gm"), raw_file_paths[raw_file_path_select])
# raw_file_labels <- c("alff_age", "alff_sex", "cbf_age", "cbf_sex")
#
# yeo7_df_raw <- get_prop_sig(raw_file_paths, raw_file_labels, yeo7, gm_mask)
# ggplot(yeo7_df_raw, aes(network_ids, proportion)) +
#     geom_col() +
#     geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
#                   position = position_dodge(.9)) +
#     facet_wrap(~ map_name) +
#     labs(title = "Raw on Yeo7") +
#     theme_classic()
#
# aal_sym_df_raw <- get_prop_sig(raw_file_paths, raw_file_labels, aal_sym, gm_mask)
# ggplot(aal_sym_df_raw, aes(network_ids, proportion)) +
#     geom_col() +
#     geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
#                   position = position_dodge(.9)) +
#     facet_wrap(~ map_name) +
#     labs(title = "Raw on AAL") +
#     theme_classic()
# Run through local
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)) %>%
ggsave(file.path(settings$output_dir, "figures", "yeo7_pval-prop_fdr05.png"), .)
ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90))
ggsave(file.path(settings$output_dir, "figures", "yeo7_pval-prop_fdr05.png"))
png(file.path(settings$output_dir, "figures", "yeo7_pval-prop_fdr05.png"))
png(file.path(settings$output_dir, "figures", "yeo7_pval-prop_fdr05.png"), type = "cairo")
yeo7_barplot <- ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)); yeo7_barplot
print(yeo7_barplot)
?ggsave
yeo7_barplot <- ggplot(yeo7_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on Yeo7") +
scale_x_discrete(labels = c("Visual", "Somatomotor", "Dorsal Attention", "Ventral Attention", "Limbic", "Frontoparietal", "Default")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)); yeo7_barplot
ggsave(plot = yeo7_barplot, file.path(settings$output_dir, "figures", "yeo7_pval-prop_fdr05.png"), type = "cairo-png")
aal_barplot <- ggplot(aal_sym_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on AAL") +
scale_x_discrete(labels = c("Hippocampus", "Amygdala", "Caudate", "Putamen", "Pallidum", "Thalamus")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)); aal_barplot
ggsave(plot = aal_barplot, file.path(settings$output_dir, "figures", "aal_pval-prop_fdr05.png"), type = "cairo-png")
aal_sym_df <- get_prop_sig(file_paths, file_labels, aal_sym, gm_mask)
aal_barplot <- ggplot(aal_sym_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on AAL") +
scale_x_discrete(labels = c("Hippocampus", "Amygdala", "Caudate", "Putamen", "Pallidum", "Thalamus")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)); aal_barplot
ggsave(plot = aal_barplot, file.path(settings$output_dir, "figures", "aal_pval-prop_fdr05.png"), type = "cairo-png")
aal_sym_df <- get_prop_sig(file_paths, file_labels, aal_sym, gm_mask)
aal_sym_df <- get_prop_sig(file_paths, file_labels, aal_sym, settings$mask_path)
aal_barplot <- ggplot(aal_sym_df, aes(network_ids, proportion)) +
geom_col() +
geom_errorbar(aes(ymin = proportion - se, ymax = proportion + se), width = .2,
position = position_dodge(.9)) +
facet_wrap(~ map_name) +
labs(title = "PCA on AAL") +
scale_x_discrete(labels = c("Hippocampus", "Amygdala", "Caudate", "Putamen", "Pallidum", "Thalamus")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90)); aal_barplot
ggsave(plot = aal_barplot, file.path(settings$output_dir, "figures", "aal_pval-prop_fdr05.png"), type = "cairo-png")
