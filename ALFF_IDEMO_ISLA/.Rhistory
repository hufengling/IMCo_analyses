idemo_qa <- read_csv("/projects/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
library(tidyverse)
library(ANTsRCore)
library(extrantsr)
library(IMCo)
build(IMco)
library(devtools)
library(tidyverse)
library(ANTsRCore)
library(extrantsr)
library(IMCo)
library(IMCo)
library(tidyverse)
library(ANTsRCore)
library(extrantsr)
library(IMCo)
idemo_qa <- read_csv("/projects/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
idemo_qa <- read_csv("/projects/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
get_wd()
getwd()
idemo_qa <- read_csv("/projects/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
setwd("/")
idemo_qa <- read_csv("/projects/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
getwd()
idemo_qa <- read_csv("/project/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
setwd("/home/fengling/Documents/IMCo_analyses/ALFF_IDEMO_ISLA")
idemo_qa <- read_csv("/project/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
idemo <- read_csv("PNC/pnc/idemodata/n1601_idemoBehavior_20151130.csv")
idemo <- read_csv("~/Documents/IMCo/PNC/pnc/idemodata/n1601_idemoBehavior_20151130.csv")
idemo_qa <- read_csv("/project/pnc/idemodata/n1601_idemo_FinalQA_092817.csv")
idemo_qa <- read_csv("input/idemodata/n1601_idemo_FinalQA_092817.csv")
idemo <- read_csv("input/idemodata/n1601_idemoBehavior_20151130.csv")
idemo_health <- read_csv("input/idemodata/n1601_health_20170421.csv")
binded <- read_csv("input/demographics/binded_demographics.csv")
binded <- read_csv("input/pnc/demographics/binded_demographics.csv")
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
idemo <- idemo %>% filter(idemoBehHappyCorrectCount >= 8)
idemo_health <- idemo_health %>% filter(ltnExcludev2 == 0)
binded <- binded %>% rename(scanid = "id")
common_pts <- Reduce(intersect, list(idemo_qa$scanid, idemo$scanid, idemo_health$scanid, binded$scanid)) %>%
as.data.frame() %>%
rename(file_name = ".")
alff_files <- common_pts %>% mutate(file_name = paste0(file_name, "_alffStd.nii.gz"))
cbf_files <- common_pts %>% mutate(file_name = paste0(file_name, "_asl_quant_ssT1Std.nii.gz"))
idemo_files <- common_pts %>% mutate(file_name = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz"))
alff_files <- common_pts %>% mutate(file_name = paste0(file_name, "_alffStd.nii.gz"))
cbf_files <- common_pts %>% mutate(file_name = paste0(file_name, "_asl_quant_ssT1Std.nii.gz"))
idemo_files <- common_pts %>% mutate(file_name = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz"))
file_path()
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(file_name, "_alffStd.nii.gz")) %>%
mutate(modality_2 = paste0(file_name, "_asl_quant_ssT1Std.nii.gz")) %>%
mutate(modality_3 = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz"))
View(input_filepaths)
input_dir <- "input/" #base directory for all inputs
nifti_dir <- file.path(input_dir, list("alff/",
"cbf/",
"copefile/"))
output_dir <- "output" #base directory for all outputs
input_dir <- "input" #base directory for all inputs
nifti_dir <- file.path(input_dir, list("alff/",
"cbf/",
"copefile/"))
pwd
pwd
## Global Settings
```{r}
output_dir <- "output" #base directory for all outputs
input_dir <- "input" #base directory for all inputs
nifti_dir <- file.path(input_dir,
list("alff",
"cbf",
"copefile"))
system2("pwd")
idemo_qa <- read_csv("input/csvs/idemodata/n1601_idemo_FinalQA_092817.csv")
idemo <- read_csv("input/csvs/idemodata/n1601_idemoBehavior_20151130.csv")
idemo_health <- read_csv("input/csvs/idemodata/n1601_health_20170421.csv")
binded <- read_csv("input/csvs/demographics/binded_demographics.csv")
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
getwd()
library(here)
install.packages("here")
library(here)
library(ANTsRCore)
library(extrantsr)
library(IMCo)
library(here)
idemo_qa <- read_csv(here("input/csvs/idemodata/n1601_idemo_FinalQA_092817.csv"))
idemo <- read_csv(here("input/csvs/idemodata/n1601_idemoBehavior_20151130.csv"))
idemo_health <- read_csv(here("input/csvs/idemodata/n1601_health_20170421.csv"))
binded <- read_csv(here("input/csvs/demographics/binded_demographics.csv"))
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
idemo <- idemo %>% filter(idemoBehHappyCorrectCount >= 8)
?system
?system2
system("pwd", stdout = TRUE)
idemo_qa <- read_csv(here("input/csvs/idemodata/n1601_idemo_FinalQA_092817.csv"))
idemo <- read_csv(here("input/csvs/idemodata/n1601_idemoBehavior_20151130.csv"))
idemo_health <- read_csv(here("input/csvs/idemodata/n1601_health_20170421.csv"))
binded <- read_csv(here("input/csvs/demographics/binded_demographics.csv"))
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
idemo <- idemo %>% filter(idemoBehHappyCorrectCount >= 8)
idemo_health <- idemo_health %>% filter(ltnExcludev2 == 0)
binded <- binded %>% rename(scanid = "id")
common_pts <- Reduce(intersect, list(idemo_qa$scanid, idemo$scanid, idemo_health$scanid, binded$scanid)) %>%
as.data.frame() %>%
rename(file_name = ".")
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(file_name, "_alffStd.nii.gz")) %>%
mutate(modality_2 = paste0(file_name, "_asl_quant_ssT1Std.nii.gz")) %>%
mutate(modality_3 = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz"))
View(input_filepaths)
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(file_name, "_alffStd.nii.gz") %>% file_path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(file_name, "_asl_quant_ssT1Std.nii.gz")%>% file_path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz") %>% file_path("input/niftis/idemodata", .))
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(file_name, "_alffStd.nii.gz") %>% file.path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(file_name, "_asl_quant_ssT1Std.nii.gz")%>% file.path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz") %>% file.path("input/niftis/idemodata", .))
common_pts <- Reduce(intersect, list(idemo_qa$scanid, idemo$scanid, idemo_health$scanid, binded$scanid)) %>%
as.data.frame() %>%
rename(file_name = ".")
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(file_name, "_alffStd.nii.gz") %>% file.path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(file_name, "_asl_quant_ssT1Std.nii.gz")%>% file.path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(file_name, "_sigchange_cope1_TaskStd.nii.gz") %>% file.path("input/niftis/idemodata", .))
```{r}
View(input_filepaths)
View(binded)
rm(common_pts, idemo, idemo_health, idemo_qa)
View(binded)
idemo_qa <- read_csv(here("input/csvs/idemodata/n1601_idemo_FinalQA_092817.csv"))
idemo <- read_csv(here("input/csvs/idemodata/n1601_idemoBehavior_20151130.csv"))
idemo_health <- read_csv(here("input/csvs/idemodata/n1601_health_20170421.csv"))
pnc_demographics <- read_csv(here("input/csvs/demographics/binded_demographics.csv"))
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
idemo <- idemo %>% filter(idemoBehHappyCorrectCount >= 8)
idemo_health <- idemo_health %>% filter(ltnExcludev2 == 0)
pnc_demographics <- pnc_demographics %>% rename(scanid = "id")
common_pts <- Reduce(intersect, list(idemo_qa$scanid, idemo$scanid, idemo_health$scanid, pnc_demographics$scanid)) %>%
as.data.frame() %>%
rename(subj_num = ".")
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(subj_num, "_alffStd.nii.gz") %>% file.path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(subj_num, "_asl_quant_ssT1Std.nii.gz")%>% file.path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(subj_num, "_sigchange_cope1_TaskStd.nii.gz") %>% file.path("input/niftis/idemodata", .))
rm(common_pts, idemo, idemo_health, idemo_qa)
rm(binded)
nifti_dir <- file.path(input_dir,
list("alff",
"cbf",
"idemo"))
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(subj_num, "_alffStd.nii.gz") %>% file.path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(subj_num, "_asl_quant_ssT1Std.nii.gz")%>% file.path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(subj_num, "_sigchange_cope1_TaskStd.nii.gz") %>% file.path("input/niftis/idemo", .))
idemo_qa <- read_csv(here("input/csvs/idemodata/n1601_idemo_FinalQA_092817.csv"))
idemo <- read_csv(here("input/csvs/idemodata/n1601_idemoBehavior_20151130.csv"))
idemo_health <- read_csv(here("input/csvs/idemodata/n1601_health_20170421.csv"))
pnc_demographics <- read_csv(here("input/csvs/demographics/binded_demographics.csv"))
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
idemo <- idemo %>% filter(idemoBehHappyCorrectCount >= 8)
idemo_health <- idemo_health %>% filter(ltnExcludev2 == 0)
pnc_demographics <- pnc_demographics %>% rename(scanid = "id")
common_pts <- Reduce(intersect, list(idemo_qa$scanid, idemo$scanid, idemo_health$scanid, pnc_demographics$scanid)) %>%
as.data.frame() %>%
rename(subj_num = ".")
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(subj_num, "_alffStd.nii.gz") %>% file.path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(subj_num, "_asl_quant_ssT1Std.nii.gz")%>% file.path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(subj_num, "_sigchange_cope1_TaskStd.nii.gz") %>% file.path("input/niftis/idemo", .))
rm(common_pts, idemo, idemo_health, idemo_qa)
output_dir <- "output" #base directory for all outputs
input_dir <- "input" #base directory for all inputs
nifti_dir <- file.path(input_dir,
list("alff",
"cbf",
"idemo"))
View(input_filepaths)
output_dir <- here("output") #base directory for all outputs
output_dir
mask_path <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz")
output_dir <- here("output") #base directory for all outputs
input_dir <- here("input") #base directory for all inputs
nifti_dir <- file.path(input_dir,
list("alff",
"cbf",
"idemo"))
mask_path <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz")
nifti_dir <- file.path(input_dir,
list("niftis/alff",
"niftis/cbf",
"niftis/idemo"))
settings <- list(output_dir,
input_dir,
nifti_dir
mask_path)
settings <- list(output_dir,
input_dir,
nifti_dir,
mask_path)
settings
settings <- list(output_dir = output_dir,
input_dir,
nifti_dir,
mask_path)
settings
settings <- list(output_dir = output_dir,
input_dir = input_dir,
nifti_dir = nifti_dir,
mask_path = mask_path)
use_git
devtools::use_git
library(tidyverse)
library(ANTsRCore)
library(extrantsr)
library(IMCo)
library(here)
idemo_qa <- read_csv(here("input/csvs/idemodata/n1601_idemo_FinalQA_092817.csv"))
idemo <- read_csv(here("input/csvs/idemodata/n1601_idemoBehavior_20151130.csv"))
idemo_health <- read_csv(here("input/csvs/idemodata/n1601_health_20170421.csv"))
pnc_demographics <- read_csv(here("input/csvs/demographics/binded_demographics.csv"))
idemo_qa <- idemo_qa %>% filter(idemoExcludeVoxelwise == 0)
idemo <- idemo %>% filter(idemoBehHappyCorrectCount >= 8)
idemo_health <- idemo_health %>% filter(ltnExcludev2 == 0)
pnc_demographics <- pnc_demographics %>% rename(scanid = "id")
common_pts <- Reduce(intersect, list(idemo_qa$scanid, idemo$scanid, idemo_health$scanid, pnc_demographics$scanid)) %>%
as.data.frame() %>%
rename(subj_num = ".")
input_filepaths <- common_pts %>%
mutate(modality_1 = paste0(subj_num, "_alffStd.nii.gz") %>% file.path("input/niftis/alff", .)) %>%
mutate(modality_2 = paste0(subj_num, "_asl_quant_ssT1Std.nii.gz")%>% file.path("input/niftis/cbf", .)) %>%
mutate(modality_3 = paste0(subj_num, "_sigchange_cope1_TaskStd.nii.gz") %>% file.path("input/niftis/idemo", .))
rm(common_pts, idemo, idemo_health, idemo_qa)
output_dir <- here("output") #base directory for all outputs
input_dir <- here("input") #base directory for all inputs
nifti_dir <- file.path(input_dir,
list("niftis/alff",
"niftis/cbf",
"niftis/idemo"))
mask_path <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz")
settings <- list(output_dir = output_dir,
input_dir = input_dir,
nifti_dir = nifti_dir,
mask_path = mask_path)
?imco
for(i in 1:1){
print(i)
}
settings <- list(input = input_filepaths,
output_dir = output_dir,
input_dir = input_dir,
nifti_dir = nifti_dir,
mask = mask)
mask <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz") %>% check_ants()
mask <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz") %>% check_ants()
mask_path
mask <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz") %>% check_ants()
settings <- list(input = input_filepaths,
output_dir = output_dir,
input_dir = input_dir,
nifti_dir = nifti_dir,
mask = mask)
settings$input_filepaths$modality_1[1]
settings$input
settings$input$modality_1[1]
?imco
system2(pwd)
system2("pwd")
system2("Rscript R/batch_scripts/01_perform_imco.R hello world wassup")
system2("Rscript R/batch_scripts/01_perform_imco.R hello world wassup")
system2("Rscript R/batch_scripts/01_perform_imco.R hello world wassup")
pwd
system2("Rscript ~/Documents/IMCo_analyses/ALFF_CBF_IDEMO/R/batch_scripts/01_perform_imco.R hello world wassup")
system2("Rscript ~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R hello world wassup")
system2("Rscript ~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R hello world")
system("Rscript ~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R hello world")
system2("Rscript ~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R hello world")
?system2
system2("Rscript ~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R", args = c("hello", "world"))
test <- imco(list(settings$input$modality_1[1], settings$input$modality_2[1], settings$input$modality_3[1]), brainMask = settings$mask, out_dir = file.path(output_dir, "global_wcov"), out_name = "2647", ref = 1, fwhm = 3, retimg = T, type = "pca",
propMiss = 0.9, pcaType = "global", matrixType = "wcov"
)
system2("Rscript ~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R", args = c("hello", "world"))
system2("Rscript", args = c("~/Documents/IMCo_analyses/ALFF_IDEMO_ISLA/R/batch_scripts/01_perform_imco.R", "hello", "world"))
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R", "hello", "world"))
?imco
imco
x <- "hello"
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R", x, "world"))
print(mask)
mask <- file.path(input_dir, "references/masks/gm10_pcals_rest.nii.gz")
settings <- list(input = input_filepaths,
output_dir = output_dir,
input_dir = input_dir,
nifti_dir = nifti_dir,
mask_path = mask_path)
head(imco)
?for
for(i in 1:10)
print(i)
for(line in input_filepaths) {
print(line)
}
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files, settings$mask_path,
file.path(output_dir, "niftis/coupled/global_wcov")))
for(line in input_filepaths) {
print(line)
}
dim(line)
for(line in input_filepaths) {
dim(line)
}
dim(line) %>% print()
for(line in input_filepaths) {
dim(line) %>% print()
}
for(line in input_filepaths) {
dim(line) %>% print()
}
head(input_filepaths)
head(imco)
for(line in nrow(input_filepaths)) {
out_name <- line[1]
subject_files <- list(line[2], line[3], line[4])
print(out_name)
print(subject_files)
}
for(line in nrow(input_filepaths)) {
out_name <- line[1]
subject_files <- list(line[2], line[3], line[4])
print(out_name)
print(subject_files)
}
for(i in nrow(input_filepaths)) {
line <- input_filepaths[i, ]
out_name <- line[1]
subject_files <- list(line[2], line[3], line[4])
print(out_name)
print(subject_files)
}
head(imco)
fwhm <- 3
settings <- list(input = input_filepaths,
output_dir = output_dir,
input_dir = input_dir,
nifti_dir = nifti_dir,
mask_path = mask_path,
fwhm <- 3)
x <- "hello"
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input_filepaths[i, ]
out_name <- line[1]
subject_files <- list(line[2], line[3], line[4])
print(out_name)
print(subject_files)
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files, settings$mask_path,
file.path(settings$output_dir, "niftis/coupled/global_wcov")))
}
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- list(line[2], line[3], line[4])
print(out_name)
print(subject_files)
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files, settings$mask_path,
file.path(settings$output_dir, "niftis/coupled/global_wcov")))
}
head(imco)
?cat
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- cat(line[2], line[3], line[4])
print(out_name)
print(subject_files)
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files, settings$mask_path,
file.path(settings$output_dir, "niftis/coupled/global_wcov"),
))
}
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- cat(line[2], line[3], line[4])
print(out_name)
print(subject_files)
#
# system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
#                           subject_files, settings$mask_path,
#                           file.path(settings$output_dir, "niftis/coupled/global_wcov"),
#                           ))
}
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- cat(line[2], line[3], line[4])
View(line)
type(line)
typeof(line)
class(line)
subject_files <- cat(line[1, 2], line[1, 3], line[1, 4])
head(imco)
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- cat(line[1, 2], line[1, 3], line[1, 4])
print(out_name)
print(subject_files)
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files,
settings$mask_path,
file.path(settings$output_dir, "niftis/coupled/global_wcov"),
settings$fwhm,
settings$propMiss,
"global",
"wcov"))
}
subject_files <- cat(line[1, 2], line[1, 3], line[1, 4])
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- cat(line[1, 2], line[1, 3], line[1, 4])
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files,
settings$mask_path,
file.path(settings$output_dir, "niftis/coupled/global_wcov"),
settings$fwhm,
settings$propMiss,
"global",
"wcov"))
}
for(i in 1:2) {#nrow(settings$input_filepaths)) {
line <- settings$input[i, ]
out_name <- line[1]
subject_files <- cat(line[1, 2], line[1, 3], line[1, 4])
system2("Rscript", args = c("R/batch_scripts/01_perform_imco.R",
subject_files,
settings$mask_path,
file.path(settings$output_dir, "niftis/coupled/global_wcov"),
settings$fwhm,
settings$propMiss,
"global",
"wcov"))
}
library(IMCo)
imco(files, mask,
ref = 1, fwhm = 3, retimg = T, type = "pca",
propMiss = 0.9, pcaType = "global", matrixType = "wcov"
)
files <- list(line[1, 2], line[1, 3], line[1, 4])
mask <- mask_path
imco(files, mask,
ref = 1, fwhm = 3,
propMiss = 0.9, pcaType = "global", matrixType = "wcov"
)
?str_split
list(c(2, 3))
get(wd)
getwd()
imco(files, mask,
out_dir = "output/niftis/coupled/global_wcov",
outname = "3234"
ref = 1, fwhm = 3,
propMiss = 0.9, pcaType = "global", matrixType = "wcov"
)
imco(files, mask,
out_dir = "output/niftis/coupled/global_wcov",
outname = "3234",
ref = 1, fwhm = 3,
propMiss = 0.9, pcaType = "global", matrixType = "wcov"
)
imco(files, mask,
out_dir = "output/niftis/coupled/global_wcov",
out_name = "3234",
ref = 1, fwhm = 3,
propMiss = 0.9, pcaType = "global", matrixType = "wcov"
)
?getNeighborhoodInMask
load_all()
library(devtools)
load_all()
