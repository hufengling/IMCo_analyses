if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_sum[1:i]))
return(dprobs_norm)
}
probs <- credint_pois(6, 5)
sum(probs)
probs
sum(probs[1:4])
sum(probs[1:1])
sum(probs[1:100])
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
return(dprobs_sum)
}
probs <- credint_pois(6, 5)
sum(probs)
probs
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 100))
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5)
sum(probs)
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5)
?which
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(arrayInd(dprobs_sum > 0.9))
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9, arr.ind = TRUE))
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(match(dprobs_sum > 0.9))
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5)
?match
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5)
return(vec)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
vec <- dprobs_ind %in% dprobs_sum
return(vec)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
vec <- dprobs_ind %in% dprobs_sum
return(vec)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
vec <- which(dprobs_ind %in% dprobs_sum)
return(vec)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- dprobs_sum > 0.9
return(dprobs_ind)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- dprobs_sum > 0.9
return(dprobs_ind)
}
probs <- credint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
print(prob_over_background)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- dprobs_sum > 0.9
return("hell")
}
probs <- credint_pois(6, 5)
probs <- credint_pois(6, 5); probs
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
vec <- which(dprobs_ind %in% dprobs_sum)
return(vec)
}
probs <- credint_pois(6, 5); probs
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- min(which(dprobs_sum > 0.9))
vec <- dprobs_ind %in% dprobs_sum
return(vec)
}
probs <- credint_pois(6, 5); probs
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_ind <- dprobs_sum > 0.9
return(dprobs_ind)
}
probs <- credint_pois(6, 5); probs
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_bool <- dprobs_sum <= 0.9
dprobs_ind <- sum(dprobs_bool)
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5); probs
confint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 100))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:100)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_bool <- dprobs_sum <= cl
dprobs_ind <- sum(dprobs_bool)
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5); probs
confint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 20))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:20)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_bool <- dprobs_sum <= cl
dprobs_ind <- sum(dprobs_bool)
return(b + dprobs_ind - 1)
}
probs <- credint_pois(6, 5); probs
?confint_pois
confint_pois(6, 5)
credint_pois <- function(n, b, cl = 0.95) {
counter <- 0
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, lambda, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 20))
dprobs <- c(dprobs, dpois(i, lambda))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:20)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_lower <- dprobs_sum <= (1 - cl) / 2
if (sum(dprobs_lower >= 1)) {
dprobs_norm <- dprobs_norm[!dprobs_lower]
counter <- sum(dprobs_lower)
}
dprobs_bool <- dprobs_sum <= cl
dprobs_ind <- sum(dprobs_bool)
return(c(counter, b + dprobs_ind + counter - 1))
}
probs <- credint_pois(6, 5); probs
probs <- credint_pois(10, 5); probs
probs <- credint_pois(30, 5); probs
credint_pois <- function(n, b, cl = 0.95) {
counter <- 0
if (n < b)
lambda <- b
else
lambda <- n
prob_over_background <- ppois(b - 1, n, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 20))
dprobs <- c(dprobs, dpois(i, n))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:20)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_lower <- dprobs_sum <= (1 - cl) / 2
if (sum(dprobs_lower >= 1)) {
dprobs_norm <- dprobs_norm[!dprobs_lower]
counter <- sum(dprobs_lower)
}
dprobs_bool <- dprobs_sum <= cl
dprobs_ind <- sum(dprobs_bool)
return(c(counter, b + dprobs_ind + counter - 1))
}
probs <- credint_pois(30, 5); probs
probs <- credint_pois(6, 5); probs
credint_pois <- function(n, b, cl = 0.95) {
counter <- 0
prob_over_background <- ppois(b - 1, n, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 20))
dprobs <- c(dprobs, dpois(i, n))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:20)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_lower <- dprobs_sum <= (1 - cl) / 2
if (sum(dprobs_lower >= 1)) {
dprobs_norm <- dprobs_norm[!dprobs_lower]
counter <- sum(dprobs_lower)
}
dprobs_bool <- dprobs_sum <= cl
dprobs_ind <- sum(dprobs_bool)
return(c(counter, b + dprobs_ind + counter - 1))
}
probs <- credint_pois(6, 5); probs
probs <- credint_pois(3, 5); probs
probs <- credint_pois(1, 5); probs
probs <- credint_pois(0, 5); probs
probs <- credint_pois(1, 5); probs
probs <- credint_pois(1:30, 5); probs
for (i in 1:30) {
print(credint_pois(i, 5, cl = 0.90))
print(confint_pois(n = i, b = 5, cl = 0.90))
}
credint_pois <- function(n, b, cl = 0.95) {
counter <- 0
prob_over_background <- ppois(b - 1, n, lower.tail = FALSE)
dprobs <- c()
for (i in b:(b + 20))
dprobs <- c(dprobs, dpois(i, n))
dprobs_norm <- dprobs / prob_over_background
dprobs_sum <- c()
for (i in 1:20)
dprobs_sum <- c(dprobs_sum, sum(dprobs_norm[1:i]))
dprobs_lower <- dprobs_sum <= (1 - cl) / 2
if (sum(dprobs_lower >= 1)) {
dprobs_norm <- dprobs_norm[!dprobs_lower]
counter <- sum(dprobs_lower)
}
dprobs_bool <- dprobs_sum <= cl
dprobs_ind <- sum(dprobs_bool)
return(c(counter, dprobs_ind + counter - 1))
}
for (i in 1:30) {
print(credint_pois(i, 5, cl = 0.90))
print(confint_pois(n = i, b = 5, cl = 0.90))
}
for (i in 1:30) {
print(paste0("For following i: ", i))
print(credint_pois(i, 5, cl = 0.90))
print(confint_pois(n = i, b = 5, cl = 0.90))
}
test <- confint_pois(n = i, b = 5, cl = 0.90)
test
test[1]
test[2]
for (i in 1:30) {
print(paste0("For following i: ", i))
tmp <- credint_pois(i, 5, cl = 0.90)
print(paste(tmp[1], tmp[2]))
}
for (i in 1:30) {
print(paste0("For following i: ", i))
print(credint_pois(i, 5, cl = 0.90))
tmp <- confint_pois(n = i, b = 5, cl = 0.90)
print(paste(tmp[1], tmp[2]))
}
confint_pois
?pnorm
for (i in 1:15) {
print(paste0("For following i: ", i))
print(credint_pois(i, 3, cl = 0.90))
tmp <- confint_pois(n = i, b = 3, cl = 0.90)
print(paste(tmp[1], tmp[2]))
}
citr:::insert_citation()
install.packages("spelling")
library(rticles
)
