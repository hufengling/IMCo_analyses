Sys.Date()
format(Sys.time(), "%d %B, %Y")
bookdown::word_document2(
bookdown::word_document2
install.packages("distill")
install.packages("rticles")
rmarkdown::pandoc_version(
)
rmarkdown::pandoc_version()
citr:::insert_citation()
library(citr)
citr:::insert_citation()
.9 - 1/3
logit((.9 - 1/3)/(2/3))
p <
p <- (.9 - 1/3)/(2/3)
p
log(p/(1-p))
p <- .9
log(p/(1-p))
For reference, in the three-modality setting, a coupling value of 0 would correspond to
p <- (.95 - 1/3)/(2/3)
p
log(p/(1-p))
p <- (.95 - 1/3)/(2/3); log(p/(1-p))
p <- (.666 - 1/3)/(2/3); log(p/(1-p))
p <- (.333 - 1/3)/(2/3); log(p/(1-p))
p <- (.334 - 1/3)/(2/3); log(p/(1-p))
p <- (.99 - 1/3)/(2/3); log(p/(1-p))
p <- (.999 - 1/3)/(2/3); log(p/(1-p))
p <- (.97 - 1/3)/(2/3); log(p/(1-p))
p <- (.75 - 1/3)/(2/3); log(p/(1-p))
p <- (.85 - 1/3)/(2/3); log(p/(1-p))
p <- (.88 - 1/3)/(2/3); log(p/(1-p))
p <- (.92 - 1/3)/(2/3); log(p/(1-p))
p <- (.93 - 1/3)/(2/3); log(p/(1-p))
p <- (.45 - 1/3)/(2/3); log(p/(1-p))
p <- (.40 - 1/3)/(2/3); log(p/(1-p))
p <- (.41 - 1/3)/(2/3); log(p/(1-p))
p <- (.40 - 1/2)*2; log(p/(1-p))
p <- (.75 - 1/2)*2; log(p/(1-p))
p <- (.55 - 1/2)*2; log(p/(1-p))
p <- (.57 - 1/2)*2; log(p/(1-p))
p <- (.56 - 1/2)*2; log(p/(1-p))
p <- (.94 - 1/2)*2; log(p/(1-p))
p <- (.42 - 1/3)/(2/3); log(p/(1-p))
p <- (.99 - 1/3)/(2/3); log(p/(1-p))
p <- (.96 - 1/3)/(2/3); log(p/(1-p))
p <- (.98 - 1/3)/(2/3); log(p/(1-p))
source("~/.active-rstudio-document", echo=TRUE)
install.packages("freesurferformats")
library(freesurferformats)
test <- read.fs.mgh("/Users/hufengling/Documents/Penn/Shinohara/IMCo_analyses/ALFF_BASILc_REHO/output/freesurfer_images/surfaces/descriptive/lh.global_wcov_mean.mgh")
test
source("~/.active-rstudio-document", echo=TRUE)
lh_mean[lh_mean != 0]
lh_mean[lh_mean != 0] -> lh_mean
lh_mean <- lh_mean[lh_mean != 0]
lh_variance <- lh_variance[lh_variance != 0]
rh_mean <- rh_mean[rh_mean != 0]
rh_variance <- rh_variance[rh_variance != 0]
hist(lh_mean)
summar(lh_mean)
summary(lh_mean)
summary(rh_mean)
mean <- c(lh_mean, rh_mean)
variance <- c(lh_variance, rh_variance)
coupling_descriptive <- data.frame(mean = mean, variance = variance)
View(coupling_descriptive)
write.csv(coupling_descriptive, "/Users/hufengling/Documents/Penn/Shinohara/IMCo_analyses/ALFF_BASILc_REHO/output/csvs/coupling_descriptive_stats.csv"
)
summary(coupling_descriptive
)
here()
histogram(coupling$mean)
hist(coupling$mean)
hist(coupling_descriptive$mean)
hist(coupling_descriptive$variance)
lm(variance ~ mean, data = coupling_descriptive)
lm(variance ~ mean, data = coupling_descriptive) %>% summary()
plot(coupling_descriptive$mean, coupling_descriptive$variance)
summary(coupling_descriptive)
sd(coupling_descriptive$mean)m
sd(coupling_descriptive$mean)
sd(coupling_descriptive$variance
)
lm(variance ~ mean, data = coupling_descriptive) %>% summary()
citr:::insert_citation()
her()
getwd()
load("/Users/hufengling/Documents/Penn/G1/Courses/Methods/data/ESTRADL.DAT.rdata")
peds <- matrix(c(1362, 1313, 6, 2), nrow = 2); peds
fisher.test(peds)
?fisher.test
weight <- matrix(c(17, 113, 13, 7, 115, 21), nrow = 2, byrow = TRUE)
weight <- matrix(c(17, 113, 13, 7, 115, 21), nrow = 2, byrow = TRUE); weight
fisher.test(weight)
953-115
953-124
schiz <- matrix(c(115, 838, 124, 829), nrow = 2)
schiz <- matrix(c(115, 838, 124, 829), nrow = 2); schiz
chi.sq(schiz)
?chisq.test
chi.sq.test(schiz)
chisq.test(schiz)
?kappa
89+23+35
953-147
repro <- matrix(c(89, 23, 35, 806), nrow = 2); repro
p_e <- a_1 * b_1 + (1 - a_1) * (1 - b_1)
a_1 <- 112/953
b_1 <- 124/953
p_e <- a_1 * b_1 + (1 - a_1) * (1 - b_1)
a_1 <- 112/953; a_1
b_1 <- 124/953; b_1
p_e <- a_1 * b_1 + (1 - a_1) * (1 - b_1); p_e
kappa <- (p_o - p_e) / (1 - p_e)
p_o <- (89 + 806) / 953; p_o
kappa <- (p_o - p_e) / (1 - p_e); kappa
View(estradl)
estradl <- estradl %>% mutate(is_overwt = ifelse(bmi > 25, 1, 0))
install.packages("wrapper")
install.packages("wrappers")
install.packages("tidymodel")
library(tidymodel)
install.packages("tidymodels")
library(tidymodels)
install.packages("tidyr)"
install.packages("tidyr")
library(tidymodels)
library(tidyverse)
chisq_test(estradl, bmi ~ ethnic)
View(estradl)
chisq_test(estradl, bmi ~ Ethnic)
chisq_test(estradl, is_overwt ~ Ethnic)
estradl <- estradl %>% mutate(is_overwt = ifelse(bmi > 25, "yes", "no"))
chisq_test(estradl, is_overwt ~ Ethnic)
chisq_test(estradl, is_overwt ~ as.factor(Ethnic))
estradl$Ethnic <- as.factor(estradl$Ethnic)
chisq_test(estradl, is_overwt ~ Ethnic)
tab <- with(estradl, table(is_overwt, Ethnic))
chisq.test(tab)
chisq_test(estradl, is_overwt ~ Ethnic)
ocular <- matrix(c(6, 17, 37, 2, 13, 44), nrow = 2, byrow = TRUE)
chisq.test(ocular)
fisher.test(ocular)
prop.trend.test(x, n, score)
x <- c(6, 17, 37)
n <- c(8, 30, 81)
score <- 1:3
prop.trend.test(x, n, score)
x/n
f1 <- total * pnorm(19.9, u, sd)
u = 21.8
sd = 3.4
total = 143
f1 <- total * pnorm(19.9, u, sd)
f1
f1 <- total * pnorm(20, u, sd)
f2 <- total * (pnorm(23, u, sd) - pnorm(20, u, sd))
f3 <- total * (pnorm(26, u, sd) - pnorm(23, u, sd))
f4 <- total * (pnorm(29, u, sd) - pnorm(26, u, sd))
f5 <- total * pnorm(29, u, sd, lower.tail = FALSE)
expected <- c(f1, f2, f3, f4, f5); expected
observed <- c(41, 65, 20, 9, 8); observed
sum(expected)
chi_stat <- (observed - expected)^2/expected
chi_stat
observed - expected
(observed - expected)^2
(observed - expected)^2/expected
chi_stat <- sum((observed - expected)^2/expected)
chi_stat
?pchisq
pchisq(chi_stat, 2, lower.tail = FALSE)
bmi_norm <- matrix(c(expected, observed), nrow = 2, byrow = TRUE)
chisq.test(bmi_norm)
chi_stat
?chisq.test
pchisq(chi_stat, 4, lower.tail = FALSE)
chisq.test(observed, p = expected/143)
chisq.test(observed, p = expected/143, simulate.p.value = TRUE, B = 10000)
chi_stat
chisq.test(observed, p = expected/143, simulate.p.value = TRUE, B = 10000)
chisq.test(observed, p = expected/143, simulate.p.value = TRUE, B = 20000)
chisq.test(observed, p = expected/143)
expected_counts <- expected * total
expected_counts <- expected * total; expected_counts
?chisq.test
mcnemar.test(schiz)
schiz <- matrix(c(34, 81, 90, 748), nrow = 2); schiz
mcnemar.test(schiz)
sum(expected)
u = 21.8
sd = 3.4
total = 143
f1 <- pnorm(20, u, sd)
f2 <- pnorm(23, u, sd) - pnorm(20, u, sd)
f3 <- pnorm(26, u, sd) - pnorm(23, u, sd)
f4 <- pnorm(29, u, sd) - pnorm(26, u, sd)
f5 <- pnorm(29, u, sd, lower.tail = FALSE)
expected <- c(f1, f2, f3, f4, f5); expected
3/2.35482
1.273983^2
qnorm(.95)
1.65 * 9/100
sqrt(9/10)
citr:::insert_citation()
